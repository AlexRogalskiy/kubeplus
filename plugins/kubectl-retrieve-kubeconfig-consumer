#!/bin/bash

if (( $# < 1 )); then
    echo "kubectl retrieve kubeconfig consumer <Namespace in which KubePlus is deployed> [--server=<api server url>]"
    echo " --server=<api server url> is an optional argument to pass the URL of the API server. Generated kubeconfig"
    echo " will embed this URL instead of the IP based URL that is generated by KubePlus."
    exit 0
#    echo "kubectl retrieve kubeconfig consumer <Namespace in which KubePlus is deployed>" #<resourceplural> <providerKubeconfig>"
#    exit 0
fi

kubeplusNS=$1
serverURL='-1'
if (( $# == 2 )); then
	serverURL=$2
	#echo "Server URL:$serverURL"
fi


#resPlural=$2
#providerKubeconfig=$3
#pythonPath=`which python`
#if [[ $? == 0 ]]; then
#	`$pythonPath /$KUBEPLUS_HOME/plugins/consumerkubeconfigretriever.py $kubeplusNS $resPlural $providerKubeconfig`
#fi

#kubectl get configmaps kubeplus-saas-consumer-kubeconfig -n $kubeplusNS -o jsonpath="{.data.kubeplus-saas-consumer\.json}"

python /$KUBEPLUS_HOME/plugins/providerkubeconfigretriever.py $kubeplusNS $serverURL "consumer"
